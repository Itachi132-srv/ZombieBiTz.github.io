<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>ZOMBIE BITZ</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');
*{box-sizing:border-box;font-family:'Orbitron',sans-serif}
body{margin:0;background:#000;overflow:hidden;color:#fff}

/* SPACE */
#space{position:fixed;inset:0}
.star{position:absolute;width:2px;height:2px;background:#fff;animation:move 6s linear infinite}
@keyframes move{from{transform:translateY(-100vh)}to{transform:translateY(100vh)}}

/* TOP BAR */
#topBar{
position:absolute;top:10px;left:10px;right:10px;
display:flex;justify-content:space-between;align-items:center;
z-index:10;display:none
}
#profile{display:flex;align-items:center;gap:10px}
#profile img{width:40px;height:40px;border-radius:8px;border:2px solid cyan}
#scoreBox,#hpBox{background:#111;padding:8px 14px;border-radius:12px}
#hpBox{color:red}

/* BUTTONS */
.btn{padding:14px 22px;border-radius:14px;border:none;color:#fff;
background:linear-gradient(135deg,#00f,#0ff)}
.gold{background:linear-gradient(135deg,#b8860b,#ffd700)}
.emerald{background:linear-gradient(135deg,#006400,#00ff7f)}
.diamond{background:linear-gradient(135deg,#5f9ea0,#00ffff)}

#menuBtns{
position:absolute;bottom:30px;right:20px;
display:flex;gap:12px;z-index:10
}

.overlay{
position:absolute;inset:0;display:none;
justify-content:center;align-items:center;
flex-direction:column;background:rgba(0,0,0,.85);z-index:20
}

canvas{display:none}
</style>
</head>

<body>

<div id="space"></div>

<div id="topBar">
  <div id="profile">
    <img id="pfp">
    <span id="pname">PLAYER</span>
  </div>
  <div id="hpBox">HP: <span id="hp">100</span></div>
  <div id="scoreBox">SCORE: <span id="score">0</span></div>
</div>

<div id="menuBtns">
  <button class="btn emerald" onclick="openShop()">SHOP</button>
  <button class="btn gold" onclick="openSettings()">SETTINGS</button>
  <button class="btn diamond" onclick="startGame()">PLAY</button>
</div>

<!-- PROFILE -->
<div class="overlay" id="profileUI">
  <h2>PROFILE</h2>
  <input id="nameInput" placeholder="ENTER NAME">
  <input type="file" accept="image/*" onchange="setPFP(this)">
  <button class="btn" onclick="saveProfile()">SAVE</button>
  <button class="btn" onclick="closeAll()">BACK</button>
</div>

<!-- SETTINGS -->
<div class="overlay" id="settingsUI">
  <h2>SETTINGS</h2>
  <button class="btn" onclick="closeAll()">BACK</button>
</div>

<!-- SHOP -->
<div class="overlay" id="shopUI">
  <h2>SOON...</h2>
  <button class="btn" onclick="closeAll()">BACK</button>
</div>

<!-- DEFEAT -->
<div class="overlay" id="defeat">
  <h1 style="color:red">DEFEAT â˜ </h1>
  <p>SCORE: <span id="finalScore">0</span></p>
  <button class="btn" onclick="location.reload()">MAIN MENU</button>
</div>

<canvas id="game"></canvas>

<script>
/* STARS */
for(let i=0;i<80;i++){
 let s=document.createElement("div");
 s.className="star";
 s.style.left=Math.random()*100+"%";
 s.style.top=Math.random()*100+"%";
 s.style.animationDelay=Math.random()*6+"s";
 space.appendChild(s);
}

/* STORAGE */
let data=JSON.parse(localStorage.getItem("ZB"))||{name:"PLAYER",pfp:"",score:0}
pname.innerText=data.name;
if(data.pfp) pfp.src=data.pfp;
score.innerText=data.score;

/* UI */
function closeAll(){document.querySelectorAll('.overlay').forEach(o=>o.style.display="none")}
function openShop(){closeAll();shopUI.style.display="flex"}
function openSettings(){closeAll();settingsUI.style.display="flex"}

/* PROFILE */
function saveProfile(){
 if(nameInput.value) data.name=nameInput.value;
 localStorage.setItem("ZB",JSON.stringify(data));
 location.reload();
}
function setPFP(i){
 let r=new FileReader();
 r.onload=()=>{data.pfp=r.result;localStorage.setItem("ZB",JSON.stringify(data))}
 r.readAsDataURL(i.files[0])
}

/* GAME */
const c=document.getElementById("game");
const ctx=c.getContext("2d");
let x,y,bullets=[],zombies=[],poisons=[];
let hpVal=100,fireLevel=1;
let running=false,spawnTimer;

function startGame(){
 if(running) return;
 running=true;

 closeAll();
 menuBtns.style.display="none";
 topBar.style.display="flex";

 c.style.display="block";
 c.width=innerWidth;
 c.height=innerHeight;

 x=c.width/2;
 y=c.height-80;

 bullets=[];zombies=[];poisons=[];
 hpVal=100;hp.innerText=hpVal;

 spawnTimer=setInterval(spawnZombie,1000);
 requestAnimationFrame(loop);
}

c.addEventListener("mousemove",e=>x=e.clientX);
c.addEventListener("touchmove",e=>x=e.touches[0].clientX);

setInterval(()=>{
 if(!running) return;
 for(let i=0;i<fireLevel;i++)
  bullets.push({x:x+i*6-fireLevel*3,y:y});
},250);

function spawnZombie(){
 zombies.push({x:Math.random()*c.width,y:-20,s:3,hp:50,t:0});
}

function loop(){
 if(!running) return;
 ctx.clearRect(0,0,c.width,c.height);

 ctx.fillStyle="cyan";
 ctx.fillRect(x-10,y-20,20,20);

 bullets.forEach((b,i)=>{
  b.y-=8;
  ctx.fillStyle="yellow";
  ctx.fillRect(b.x,b.y,4,8);
  if(b.y<0) bullets.splice(i,1);
 });

 zombies.forEach((z,zi)=>{
  z.y+=z.s;z.t++;
  ctx.fillStyle="green";
  ctx.fillRect(z.x,z.y,14,14);

  bullets.forEach((b,bi)=>{
   if(Math.abs(b.x-z.x)<10 && Math.abs(b.y-z.y)<10){
    bullets.splice(bi,1);
    z.hp-=10;
    if(z.hp<=0){
     zombies.splice(zi,1);
     data.score+=10;
     score.innerText=data.score;
     if(Math.random()<0.12 && fireLevel<5) fireLevel++;
    }
   }
  });

  if(z.t>140){
   poisons.push({x:z.x,y:z.y});
   z.t=0;
  }
 });

 poisons.forEach((p,pi)=>{
  p.y+=5;
  ctx.fillStyle="lime";
  ctx.fillRect(p.x,p.y,6,6);
  if(Math.abs(p.x-x)<12 && Math.abs(p.y-y)<12){
   hpVal-=30;
   hp.innerText=hpVal;
   poisons.splice(pi,1);
   if(hpVal<=0) endGame();
  }
 });

 requestAnimationFrame(loop);
}

function endGame(){
 running=false;
 clearInterval(spawnTimer);
 finalScore.innerText=data.score;
 localStorage.setItem("ZB",JSON.stringify(data));
 defeat.style.display="flex";
}
</script>
</body>
</html>
